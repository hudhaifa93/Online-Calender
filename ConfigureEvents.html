<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Code Hunters - Configure Calendar</title>
        <link rel="stylesheet" href="css/fullcalendar.min.css"/>
        <link rel="stylesheet" href="css/bootstrap.min.css"/>
        <link rel="stylesheet" href="css/app.min.1.css"/>
        <link rel="stylesheet" href="css/app.min.2.css"/>
        <link rel="stylesheet" href="css/socicon.min.css"/>
        <link rel="stylesheet" href="css/jquery-ui.css"/>
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places"></script>
        <script type="text/javascript" src="js/jquery.js"></script>
        <script src="js/jquery-ui.js"></script>
        <script type="text/javascript" src="js/bootstrap.min.js"></script>
        <script src="js/googleAddress.js"></script>
        <script src="js/functions.js"></script>
        <style type="text/css">
            body {
                margin: 0px auto;
				margin-top:20px;
				background-color:#CCCCCC;
            }
            .bs-example {
                margin: 20px;
            }
            .modal-footer {
                border-top: 0px !important;
            }
            .bootstrap-tagsinput {
                width: 100%;
            }
            .tags {
                float: left;
                margin-right: 2px;
                margin-bottom: 7px;
                margin-top: 1px;
                height: 22px;
                border-radius: 4px;
                border: 1px solid #cccccc;
                font: normal 14px/20px 'Sanchez';
                background: #ebeaea;
                background: -o-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -webkit-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -moz-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -ms-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: linear-gradient(top, #C4CDE0, #C4CDE0);
                filter: progid:DXImageTransform.Microsoft.Gradient(startColorStr="#C4CDE0", endColorStr="#C4CDE0");
                border-color: #cccccc;
                cursor: pointer;
                box-shadow: inset 0 2px 0 rgba(255, 255, 255, 0.3);
                padding-left: 6px;
                padding-right: 28px;
                position: relative;
            }
            .tags .delete {
                display: block;
                width: 20px;
                height: 20px;
                float: right;
                background: url('../Content/images/panel_tools.png') no-repeat -16px 0px;
                margin-left: 6px;
                border-left: 1px solid #ccc;
                position: absolute;
                top: 0;
                right: 0;
            }
            .modal .modal-body {
                max-height: 420px;
                overflow-y: auto;
            }
            .new_alert-success{
                border: 1px solid rgb(124, 252, 124);
                background: rgb(198, 253, 198);
                position: fixed;
                top: 100px;
                right: 0;
                padding: 20px 10px;
                color:  green ;
                font-size: 15px;
                z-index: 9999999;
            }
            .new_alert-danger{
                border: 1px solid #e4b9c0;
                background: #e4b9c0;
                position: fixed;
                top: 100px;
                right: 0;
                padding: 20px 10px;
                color:  #843534 ;
                font-size: 15px;
                z-index: 9999999;
            }
            .nav-tabs > li.active > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
                border-color: #eee #eee #0a6ebd;
            }
            .nav-tabs {
                border-bottom: 1px solid #ddd;
            }
            #txtSearch {
                border: 0;
                height: 40px;
                padding: 0 10px 0 40px;
                font-size: 18px;
                width: 500px;
                border-radius: 2px;
                color: white;
                background-color: rgba(255, 255, 255, 0.26);
                background-image: url("././img/icons/search.png");
                background-repeat: no-repeat;
                background-position: 10px center;
            }
            .bootstrap-tagsinput {
                width: 100%;
            }

            .tags {
                float: left;
                margin-right: 2px;
                margin-bottom: 7px;
                margin-top: 1px;
                height: 22px;
                border-radius: 4px;
                border: 1px solid #cccccc;
                font: normal 14px/20px 'Sanchez';
                background: #ebeaea;
                background: -o-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -webkit-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -moz-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -ms-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: linear-gradient(top, #C4CDE0, #C4CDE0);
                filter: progid:DXImageTransform.Microsoft.Gradient(startColorStr="#C4CDE0", endColorStr="#C4CDE0");
                border-color: #cccccc;
                cursor: pointer;
                box-shadow: inset 0 2px 0 rgba(255, 255, 255, 0.3);
                padding-left: 6px;
                padding-right: 28px;
                position: relative;
            }
            .tags .delete {
                display: block;
                width: 20px;
                height: 20px;
                float: right;
                background: url('../Content/images/panel_tools.png') no-repeat -16px 0px;
                margin-left: 6px;
                border-left: 1px solid #ccc;
                position: absolute;
                top: 0;
                right: 0;
            }
            #footer{
                background: #B81A0E;
                box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.3);
                height: 100px;
                z-index: 10;
                width: 100%;
                left: 0;
                padding-right: 10px;
            }

        </style>
        <script>

            $(document).ready(function () {

                $("#createdby").val(localStorage.getItem("memberId"));

                initialize();//Google Address Initilization

                $("#StartDate").datepicker({
                    dateFormat: "yy-mm-dd"
                });
                $("#EndDate").datepicker({
                    dateFormat: "yy-mm-dd"
                });

                $("#fullday").change(function () {
                    if (this.checked) {
                        $("#timeAllocation").hide();
                        $("#timeAllocation input").val("");
                    }
                    else {
                        $("#timeAllocation").show();
                    }
                });

                $("#addLocation").change(function () {
                    if (this.checked) {
                        $("#locationAllocation").show();
                    }
                    else {
                        $("#locationAllocation").hide();
                        $("#locationAllocation input").val("");
                    }
                });

                $("#repeat").change(function () {
                    if (this.checked) {
                        $("#repeatAllocation").show();
                    }
                    else {
                        $("#repeatAllocation").hide();
                    }
                });


                //new
                if(localStorage.getItem("advanceID")==0){
                    $("#advanceButton").attr("onclick","javascript: saveAdvanceEvent('frmMeeting')");
                    $("#Subject").val(localStorage.getItem("tempSubject"));
                    $("textarea#Description").val(localStorage.getItem("tempDescription"));
                    var tempDate = localStorage.getItem("tempClickedDate");
                    $('#StartDate').datepicker("setDate", new Date(dateFormat(new Date(tempDate),'y'),dateFormat(new Date(tempDate),'m')-1,dateFormat(new Date(tempDate),'d')) );
                    $('#EndDate').datepicker("setDate", new Date(dateFormat(new Date(tempDate),'y'),dateFormat(new Date(tempDate),'m')-1,dateFormat(new Date(tempDate),'d')) );
                    $('#Type').on('change', function (e) {
                        var valueSelected = this.value;
                        $("#notetype").val(valueSelected);
                    });

                }
                else{//update
                    $("#Type").prop("disabled", true);
                    $("#advanceButton").attr("onclick","javascript: updateAdvanceEvent('frmMeeting')");
                    debugger;
                    $.ajax({
                        url:"process/index.php?route=event&method=getAdvanceEventData",
                        type: "post",
                        dataType: 'json',
                        async:false,
                        data:"id="+localStorage.getItem("advanceID"),
                        success: function (e) {
                            debugger;
                            var data = e;
                            data = JSON.parse(data.success);
                            data = data[0];
                            //console.log(data);
                            $('#Type').val(data.notetype);
                            $('#Subject').val(data.subject);
                            if(data.location=="0"){
                                debugger;
                                $('#addLocation').prop('checked', false);
                                $("#locationAllocation").hide();
                                $("#locationId").val("0");
                            }
                            else
                            {
                                $('#addLocation').prop('checked', true);
                                $("#locationAllocation").show();
                                $("#locationId").val(data.locationid);
                            }

                            if(data.timeslotid=="0"){
                                $('#fullday').prop('checked', true);
                                $("#timeAllocation").hide();
                            }
                            else
                            {
                                $('#fullday').prop('checked', false);
                                $("#timeAllocation").show();
                            }

                            if(data.repeat==""){
                                $('#repeat').prop('checked', false);
                                $("#repeatAllocation").hide();
                                $("#repeatId").val("");
                            }
                            else
                            {
                                $('#repeat').prop('checked', true);
                                $("#repeatAllocation").show();
                                $("#repeatId").val(data.repeat);
                            }

                            $('#StartDate').datepicker("setDate", new Date(dateFormat(new Date(data.startdate),'y'),dateFormat(new Date(data.startdate),'m')-1,dateFormat(new Date(data.startdate),'d')) );
                            $('#EndDate').datepicker("setDate", new Date(dateFormat(new Date(data.enddate),'y'),dateFormat(new Date(data.enddate),'m')-1,dateFormat(new Date(data.enddate),'d')) );
                            $("textarea#Description").val(data.description);


                            $('#street').val(data.street);
                            $('#city').val(data.city);
                            $('#state').val(data.state);
                            $('#country').val(data.country);

                            $('#StartTime').val(data.starttime);
                            $('#EndTime').val(data.endtime);

                            loadInvitee();
                        }
                    });

                }


//                $("#repeats")
//                        .change(function () {
//                            debugger;
//                            if ($("#repeats option:selected").val() == "week") {
//                                var combo = $("#repeatCombo");
//                                combo.empty();
//                                for (var i = 1; i < 11; i++) {
//                                    combo.append($("<option />").val(i).text(i));
//                                }
//                            }
//                            else if ($("#repeats option:selected").val() == "day") {
//                                var combo = $("#repeatCombo");
//                                for (var i = 1; i < 31; i++) {
//                                    combo.append($("<option />").val(i).text(i));
//                                }
//                            }
//                            else if ($("#repeats option:selected").val() == "Y") {
//                                var combo = $("#repeatCombo");
//                                combo.empty();
//                                for (var i = 1; i < 5; i++) {
//                                    combo.append($("<option />").val(i).text(i));
//                                }
//                            }
//                            else if ($("#repeats option:selected").val() == "M") {
//                                var combo = $("#repeatCombo");
//                                combo.empty();
//                                for (var i = 1; i < 24; i++) {
//                                    combo.append($("<option />").val(i).text(i));
//                                }
//                            }
//                        })
//                        .change();

            });

            function loadInvitee(){
                $.ajax({
                    url: "process/index.php?route=event&method=getinvitebynoteid",
                    type: "post",
                    dataType: 'json',
                    data: "noteid="+localStorage.getItem("advanceID"), // provided this code executes in form.onsubmit event
                    success: function (e) {
                        debugger;
                        var data = e;
                        data = JSON.parse(data.success);

                        $("#InvitedList").html('');

                        $.each( data, function( key, value ) {
                            debugger;
                            var Email = value.email;
                            var fullEmail = Email;
                            Email = Email.split("@");
                            $("#InvitedList").append($('<div data-status="'+value.status+'" class="tags ' + Email[0] + 'List" >' + fullEmail + ' <a class="" onclick="removeFromInvitedList(' + "'" + Email[0] + "'" + ')">x</a></div>'));
                        });


                    },
                    failure: function () {

                    }
                });
            }

            function addToInvitedList() {
                debugger;
                var Email = $("#InviteeEmail").val();
                var fullEmail = Email;
                Email = Email.split("@");
                $("#InvitedList").append($('<div class="tags ' + Email[0] + 'List" >' + fullEmail + '<a class="" onclick="removeFromInvitedList(' + "'" + Email[0] + "'" + ')">x</a></div>'));
                $("#InviteeEmail").val("")
            }

            function removeFromInvitedList(id) {
                debugger;

                var email = [] ;
                var removedTag = $("." + id+"List");
                var str = $( removedTag ).text();
                str = str.split("x");
                email.push({
                    "noteid" : localStorage.getItem("advanceID"),
                    "memberemail" : str[0],
                    "status" : $( removedTag ).data('status') });

                $.ajax({
                    url: "process/index.php?route=event&method=deleteinviteMembers",
                    type: "post",
                    dataType: 'json',
                    data: { deleteinvite : email}, // provided this code executes in form.onsubmit event
                    success: function (output) {
                        if(output.success=="success"){
                            showalert("Invite Revoked.", "alert-success", "", "");
                            $("." + id+"List").remove();
                        }
                    },
                    failure: function () {

                    }
                });

            }


        </script>
    </head>
	
    <body>

        <header id="header">
            <ul class="header-inner">
                <li class="logo">
                    <a href="/">CODE HUNTERS</a>
                </li>
                <li style="margin-left: 15.333333%;">
                    <input type="text" id="txtSearch">
                </li>
                <li class="pull-right">
                    <ul class="top-menu">
                        <li class="dropdown">
                            <a data-toggle="dropdown" class="tm-message" href=""></a>
                            <div class="dropdown-menu dropdown-menu-lg pull-right">
                                <div class="listview">
                                    <div class="lv-header">Messages</div>
                                    <div class="lv-body c-overflow" tabindex="1" style="overflow: hidden; outline: none;">

                                    </div>
                                    <a class="lv-footer" href="">View All</a>
                                </div>
                                <div id="ascrail2002" class="nicescroll-rails nicescroll-rails-vr"
                                     style="width: 0px; z-index: 9; cursor: default; position: absolute; top: 0px; left: 298px; height: 275px; display: none;">
                                    <div class="nicescroll-cursors" style="position: relative; top: 0px; float: right; width: 0px; height: 0px; border: 0px; border-radius: 0px; background-color: rgba(0, 0, 0, 0.498039); background-clip: padding-box;"></div>
                                </div>
                                <div id="ascrail2002-hr" class="nicescroll-rails nicescroll-rails-hr"
                                     style="height: 0px; z-index: 9; top: 275px; left: 0px; position: absolute; cursor: default; display: none;">
                                    <div class="nicescroll-cursors" style="position: absolute; top: 0px; height: 0px; width: 0px; border: 0px; border-radius: 0px; background-color: rgba(0, 0, 0, 0.498039); background-clip: padding-box;"></div>
                                </div>
                            </div>
                        </li>
                        <li class="dropdown">
                            <a data-toggle="dropdown" class="tm-notification" href=""></a>
                            <div class="dropdown-menu dropdown-menu-lg pull-right">
                                <div class="listview" id="notifications">
                                    <div class="lv-header">Notification
                                        <ul class="actions">
                                            <li class="dropdown">
                                                <a href="" data-clear="notification">
                                                    <i class="md md-done-all"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="lv-body c-overflow" tabindex="2" style="overflow: hidden; outline: none;"></div>
                                    <a class="lv-footer" href="">View Previous</a>
                                </div>
                                <div id="ascrail2003" class="nicescroll-rails nicescroll-rails-vr"
                                     style="width: 0px; z-index: 9; cursor: default; position: absolute; top: 0px; left: 298px; height: 275px; display: none;">
                                    <div class="nicescroll-cursors"
                                         style="position: relative; top: 0px; float: right; width: 0px; height: 0px; border: 0px; border-radius: 0px; background-color: rgba(0, 0, 0, 0.498039); background-clip: padding-box;"></div>
                                </div>
                                <div id="ascrail2003-hr" class="nicescroll-rails nicescroll-rails-hr"
                                     style="height: 0px; z-index: 9; top: 275px; left: 0px; position: absolute; cursor: default; display: none;">
                                    <div class="nicescroll-cursors"
                                         style="position: absolute; top: 0px; height: 0px; width: 0px; border: 0px; border-radius: 0px; background-color: rgba(0, 0, 0, 0.498039); background-clip: padding-box;"></div>
                                </div>
                            </div>
                        </li>
                        <li class="dropdown">
                            <a data-toggle="dropdown" class="tm-task" href=""></a>
                            <div class="dropdown-menu dropdown-menu-sm pull-right">
                                <div class="listview">
                                    <div class="lv-header">Profile</div>
                                    <div class="lv-body c-overflow" tabindex="1" style="overflow: hidden; outline: none;">
                                        <a class="lv-item viewshareCal" href="">
                                            <div class="media">
                                                <div class="pull-left">
                                                    <i class="glyphicon glyphicon-log-out " style="color: #f44336" ></i>
                                                </div>
                                                <div class="media-body">
                                                    <small class="lv-small">View Shared Calendars</small>
                                                </div>
                                            </div>
                                        </a>
                                        <a class="lv-item shareCal" href="" >
                                            <div class="media" onclick="">
                                                <div class="pull-left">
                                                    <i class="glyphicon glyphicon-log-out " style="color: #f44336" ></i>
                                                </div>
                                                <div class="media-body">
                                                    <small class="lv-small">Share Calendar</small>
                                                </div>
                                            </div>
                                        </a>
                                        <a class="lv-item logout" href="">
                                            <div class="media">
                                                <div class="pull-left">
                                                    <i class="glyphicon glyphicon-log-out " style="color: #f44336" ></i>
                                                </div>
                                                <div class="media-body">
                                                    <small class="lv-small">logout</small>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="pull-right logo" >
                    <img class="lv-img-sm img-circle pull-left img-responsive img-thumbnail " src="img/profile-pics/1.jpg" alt="">
                    <a class="pull-right" ><?=$user['name']?></a>
                </li>
            </ul>
        </header>

        <section class="main" >
            <div class="content" >
                <div class="container" >
                    <div class="block-header">
                        <h2>&nbsp;</h2>
                        <h2>&nbsp;</h2>
                        <h2>&nbsp;</h2>
                        <h2>&nbsp;</h2>
                    </div>
                    <div style="background-color:#FFFFFF; overflow: auto;" class="col-lg-10" > <!--heshani added a new div-->
                        <form role="form" id="frmMeeting">

                            <input type=hidden name=status value="1">
                            <input type=hidden name=createdby id="createdby" value="">
                            <input type=hidden id="notetype" name=notetype value="1">
                            <input type=hidden id="locationId"  value="">
                            <input type=hidden id="repeatId"  value="">

                            <div class="col-xs-12 form-group" style="margin-top:10px;">
                                <label>Type</label>
                                <select name="" id="Type" class="form-control" style="width:30%;">
                                    <option value="1">Meeting</option>
                                    <option value="2">Note</option>
                                    <!--<option value="3">Birthday</option>-->
                                </select>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label>Subject</label>
                                <input type="text" class="form-control" name="subject" id="Subject" placeholder="Subject"/>
                            </div>
                            <div class="col-xs-6 form-group">
                            </div>
                            <div class="col-xs-12 form-group">
                                <label>Location</label>
                                <input type="checkbox" id="addLocation">
                            </div>
                            <div id="locationAllocation" style="display:none;">
                                <div class="col-xs-12 form-group">
                                    <input type="text" class="form-control" id="autocomplete" placeholder="Enter your address"/>
                                    <input type="text"  style="margin-top: 10px;margin-bottom: 10px;" class="googleAddress form-control" id="street"/>
                                    <input  style="float: left;  width: 25%;  margin-right: 10px;" type="text" class="googleAddress form-control" id="city"/>
                                    <input  style="float: left;  width: 25%;  margin-right: 10px;" type="text" class="googleAddress form-control" id="state"/>
                                    <input  style="float: left;  width: 25%;" type="text" class="googleAddress form-control" id="country"/>
                                </div>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label>Start Date</label>
                                <input type="text" class="form-control" name="startDate" id="StartDate" placeholder="Start Date"/>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label>End Date</label>
                                <input type="text" class="form-control" name="endDate" id="EndDate" placeholder="End Date"/>
                            </div>
                            <div class="col-xs-12 form-group">
                                <label>Full Day</label>
                                <input type="checkbox" id="fullday" checked="checked">
                            </div>
                            <div id="timeAllocation" style="display:none">
                                <div class="col-xs-6 form-group">
                                    <label>Start Time</label>
                                    <input type="text" class="form-control" name="" id="StartTime" placeholder="Start Time"/>
                                </div>
                                <div class="col-xs-6 form-group">
                                    <label>End Time</label>
                                    <input type="text" class="form-control" name="" id="EndTime" placeholder="End Time"/>
                                </div>
                            </div>
                            <div class="col-xs-12 form-group">
                                <label>Repeat</label>
                                <input type="checkbox" id="repeat" >
                            </div>
                            <div id="repeatAllocation" style="display:none">
                                <div class="col-xs-6 form-group">
                                    <div class="panel panel-default" style="" >
                                        <div class="panel-body" style="">
                                            <div class="col-xs-6 form-group">
                                                <strong>Repeats:</strong>
                                            </div>
                                            <div class="col-xs-6 form-group">
                                                <select name="" id="repeats" class="form-control" style="">
                                                    <option value="M">Monthly</option>
                                                    <option value="W">Weekly</option>
                                                    <option value="Y">Yearly</option>
                                                </select>
                                            </div>
                                            <!--<div class="col-xs-6 form-group">-->
                                            <!--<strong>Repeats Every</strong>-->
                                            <!--</div>-->
                                            <!--<div class="col-xs-6 form-group">-->
                                            <!--<select name="" id="repeatCombo" class="form-control" style="">-->

                                            <!--</select>-->
                                            <!--</div>-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 form-group">
                                <label>Meeting Description</label>
                                <textarea class="form-control custom-control" name="description" id="Description" rows="5" style="resize:none"></textarea>
                            </div>
                        </form>
                        <form id="inviteeForm" style="margin-top:10px">
                            <div class="col-xs-6 form-group" style="margin-top:10px;">
                                <input type="email"  class="form-control"  id="InviteeEmail" placeholder="InviteeEmail"/><button type="button" style=" float: left;  margin-top: 5px;" class="btn btn-sm btn-primary"onclick="addToInvitedList()">Add to List</button>
                                <!--<button type="button" style="  margin-left: 10px;  float: left;  margin-top: 2px;" class="btn btn-sm btn-primary"onclick="inviteList()">Invite</button>-->
                            </div>
                            <div class="col-xs-12 form-group">
                                <div id="InvitedList">
                                </div>
                            </div>
                        </form>

                        <div class="col-xs-12 form-group">
                            <button type="button" id="advanceButton" class="btn btn-sm btn-primary" onClick="">CREATE</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <footer id="footer" >
            <center>
                <img class="" src="img/ch_logo.png" alt="Code Hunters Logo" style="padding: 20px;height: 100px;">
                <span style="color: #fff;font-size:15px;font-weight: 100;">&copy; 2015 Code Hunters. All Rights Reserved.</span>
            </center>
        </footer>
    </body>
</html>                                		                                		