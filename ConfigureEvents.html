<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Code Hunters - Configure Calendar</title>
        <link rel="stylesheet" href="css/bootstrap.min.css"/>
        <link rel="stylesheet" type="text/css" href="css/jquery-ui.css">
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places"></script>
        <script type="text/javascript" src="js/jquery.js"></script>
        <script src="js/jquery-ui.js"></script>
        <script type="text/javascript" src="js/bootstrap.min.js"></script>
        <script src="js/googleAddress.js"></script>
        <script src="js/functions.js"></script>
        <style type="text/css">
            body {
                width: 960px;
                margin: 0px auto;
            }
            .bs-example {
                margin: 20px;
            }
            .modal-footer {
                border-top: 0px !important;
            }
            .bootstrap-tagsinput {
                width: 100%;
            }
            .tags {
                float: left;
                margin-right: 2px;
                margin-bottom: 7px;
                margin-top: 1px;
                height: 22px;
                border-radius: 4px;
                border: 1px solid #cccccc;
                font: normal 14px/20px 'Sanchez';
                background: #ebeaea;
                background: -o-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -webkit-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -moz-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: -ms-linear-gradient(top, #C4CDE0, #C4CDE0);
                background: linear-gradient(top, #C4CDE0, #C4CDE0);
                filter: progid:DXImageTransform.Microsoft.Gradient(startColorStr="#C4CDE0", endColorStr="#C4CDE0");
                border-color: #cccccc;
                cursor: pointer;
                box-shadow: inset 0 2px 0 rgba(255, 255, 255, 0.3);
                padding-left: 6px;
                padding-right: 28px;
                position: relative;
            }
            .tags .delete {
                display: block;
                width: 20px;
                height: 20px;
                float: right;
                background: url('../Content/images/panel_tools.png') no-repeat -16px 0px;
                margin-left: 6px;
                border-left: 1px solid #ccc;
                position: absolute;
                top: 0;
                right: 0;
            }
            .modal .modal-body {
                max-height: 420px;
                overflow-y: auto;
            }
            .new_alert-success{
                border: 1px solid rgb(124, 252, 124);
                background: rgb(198, 253, 198);
                position: fixed;
                top: 100px;
                right: 0;
                padding: 20px 10px;
                color:  green ;
                font-size: 15px;
                z-index: 9999999;
            }
            .new_alert-danger{
                border: 1px solid #e4b9c0;
                background: #e4b9c0;
                position: fixed;
                top: 100px;
                right: 0;
                padding: 20px 10px;
                color:  #843534 ;
                font-size: 15px;
                z-index: 9999999;
            }
        </style>
        <script>

            $(document).ready(function () {

                $("#createdby").val(localStorage.getItem("memberId"));

                initialize();//Google Address Initilization

                $("#StartDate").datepicker({
                    dateFormat: "yy-mm-dd"
                });
                $("#EndDate").datepicker({
                    dateFormat: "yy-mm-dd"
                });

                $("#fullday").change(function () {
                    if (this.checked) {
                        $("#timeAllocation").hide();
                        $("#timeAllocation input").val("");
                    }
                    else {
                        $("#timeAllocation").show();
                    }
                });

                $("#addLocation").change(function () {
                    if (this.checked) {
                        $("#locationAllocation").show();
                    }
                    else {
                        $("#locationAllocation").hide();
                        $("#locationAllocation input").val("");
                    }
                });

                //new
                if(localStorage.getItem("advanceID")==0){
                    $("#advanceButton").attr("onclick","javascript: saveAdvanceEvent('frmMeeting')");
                    $("#Subject").val(localStorage.getItem("tempSubject"));
                    $("textarea#Description").val(localStorage.getItem("tempDescription"));
                    var tempDate = localStorage.getItem("tempClickedDate");
                    $('#StartDate').datepicker("setDate", new Date(dateFormat(new Date(tempDate),'y'),dateFormat(new Date(tempDate),'m')-1,dateFormat(new Date(tempDate),'d')) );
                    $('#EndDate').datepicker("setDate", new Date(dateFormat(new Date(tempDate),'y'),dateFormat(new Date(tempDate),'m')-1,dateFormat(new Date(tempDate),'d')) );
                    $('#Type').on('change', function (e) {
                        var valueSelected = this.value;
                        $("#notetype").val(valueSelected);
                    });

                }
                else{//update
                    $("#Type").prop("disabled", true);
                    $("#advanceButton").attr("onclick","javascript: updateAdvanceEvent('frmMeeting')");
                    debugger;
                    $.ajax({
                        url:"process/index.php?route=event&method=getAdvanceEventData",
                        type: "post",
                        dataType: 'json',
                        async:false,
                        data:"id="+localStorage.getItem("advanceID"),
                        success: function (e) {
                            debugger;
                            var data = e;
                            data = JSON.parse(data.success);
                            data = data[0];
                            //console.log(data);
                            $('#Type').val(data.notetype);
                            $('#Subject').val(data.subject);
                            if(data.location=="0"){
                                debugger;
                                $('#addLocation').prop('checked', false);
                                $("#locationAllocation").hide();
                                $("#locationId").val("0");
                            }
                            else
                            {
                                $('#addLocation').prop('checked', true);
                                $("#locationAllocation").show();
                                $("#locationId").val(data.locationid);
                            }

                            if(data.timeslotid=="0"){
                                $('#fullday').prop('checked', true);
                                $("#timeAllocation").hide();
                            }
                            else
                            {
                                $('#fullday').prop('checked', false);
                                $("#timeAllocation").show();
                            }
                            $('#StartDate').datepicker("setDate", new Date(dateFormat(new Date(data.startdate),'y'),dateFormat(new Date(data.startdate),'m')-1,dateFormat(new Date(data.startdate),'d')) );
                            $('#EndDate').datepicker("setDate", new Date(dateFormat(new Date(data.enddate),'y'),dateFormat(new Date(data.enddate),'m')-1,dateFormat(new Date(data.enddate),'d')) );
                            $("textarea#Description").val(data.description);


                            $('#street').val(data.street);
                            $('#city').val(data.city);
                            $('#state').val(data.state);
                            $('#country').val(data.country);

                            $('#StartTime').val(data.starttime);
                            $('#EndTime').val(data.endtime);

                            loadInvitee();
                        }
                    });




                }




            });

            function loadInvitee(){
                $.ajax({
                    url: "process/index.php?route=event&method=getinvitebynoteid",
                    type: "post",
                    dataType: 'json',
                    data: "noteid="+localStorage.getItem("advanceID"), // provided this code executes in form.onsubmit event
                    success: function (e) {
                        debugger;
                        var data = e;
                        data = JSON.parse(data.success);

                        $("#InvitedList").html('');

                        $.each( data, function( key, value ) {
                            debugger;
                            var Email = value.email;
                            var fullEmail = Email;
                            Email = Email.split("@");
                            $("#InvitedList").append($('<div class="tags ' + Email[0] + 'List" >' + fullEmail + ' <a class="" onclick="removeFromInvitedList(' + "'" + Email[0] + "'" + ')">x</a></div>'));
                        });


                    },
                    failure: function () {

                    }
                });
            }

            function addToInvitedList() {
                debugger;
                var Email = $("#InviteeEmail").val();
                var fullEmail = Email;
                Email = Email.split("@");
                $("#InvitedList").append($('<div class="tags ' + Email[0] + 'List" >' + fullEmail + '<a class="" onclick="removeFromInvitedList(' + "'" + Email[0] + "'" + ')">x</a></div>'));

            }

            function removeFromInvitedList(id) {
                debugger;
                $("." + id+"List").remove();
            }


        </script>
    </head>
    <body>
    <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">
        <li class="active"><a href="#event" data-toggle="tab">Event</a></li>
        <li><a href="#invites" data-toggle="tab">Invite</a></li>
    </ul>

    <div id="my-tab-content" class="tab-content">
        <div class="tab-pane active" id="event">
            <form role="form" id="frmMeeting">

                <input type=hidden name=status value="1">
                <input type=hidden name=createdby id="createdby" value="">
                <input type=hidden id="notetype" name=notetype value="2">
                <input type=hidden id="locationId"  value="">


                <div class="col-xs-12 form-group">
                    <label>Type</label>
                    <select name="" id="Type" class="form-control" style="width:30%;">
                        <option value="1">Meeting</option>
                        <option value="2">Note</option>
                        <!--<option value="3">Birthday</option>-->
                    </select>
                </div>


                <div class="col-xs-6 form-group">
                    <label>Subject</label>
                    <input type="text" class="form-control" name="subject" id="Subject" placeholder="Subject"/>
                </div>
                <div class="col-xs-6 form-group">
                </div>
                <div class="col-xs-12 form-group">
                    <label>Location</label>
                    <input type="checkbox" id="addLocation">
                </div>
                <div id="locationAllocation" style="display:none;">
                    <div class="col-xs-12 form-group">
                        <input type="text" class="form-control" id="autocomplete" placeholder="Enter your address"/>
                        <input type="text"  style="margin-top: 10px;margin-bottom: 10px;" class="googleAddress form-control" id="street"/>
                        <input  style="float: left;  width: 25%;  margin-right: 10px;" type="text" class="googleAddress form-control" id="city"/>
                        <input  style="float: left;  width: 25%;  margin-right: 10px;" type="text" class="googleAddress form-control" id="state"/>
                        <input  style="float: left;  width: 25%;" type="text" class="googleAddress form-control" id="country"/>
                    </div>
                </div>
                <div class="col-xs-6 form-group">
                    <label>Start Date</label>
                    <input type="text" class="form-control" name="startDate" id="StartDate" placeholder="Start Date"/>
                </div>
                <div class="col-xs-6 form-group">
                    <label>End Date</label>
                    <input type="text" class="form-control" name="endDate" id="EndDate" placeholder="End Date"/>
                </div>
                <div class="col-xs-12 form-group">
                    <label>Full Day</label>
                    <input type="checkbox" id="fullday" checked="checked">
                </div>
                <div id="timeAllocation" style="display:none">
                    <div class="col-xs-6 form-group">
                        <label>Start Time</label>
                        <input type="text" class="form-control" name="" id="StartTime" placeholder="Start Time"/>
                    </div>
                    <div class="col-xs-6 form-group">
                        <label>End Time</label>
                        <input type="text" class="form-control" name="" id="EndTime" placeholder="End Time"/>
                    </div>
                </div>
                <div class="col-xs-12 form-group">
                    <label>Meeting Description</label>
                    <textarea class="form-control custom-control" name="description" id="Description" rows="5"
                              style="resize:none"></textarea>
                </div>

                <div class="col-xs-12 form-group">
                    <button type="button" id="advanceButton" class="btn btn-sm btn-primary" onclick="">Create</button>
                </div>

            </form>
        </div>
        <div class="tab-pane" id="invites">
            <form id="inviteeForm" style="margin-top:10px">
                <div class="col-xs-6 form-group">
                    <input type="text" style="  width: 50%;  float: left;" class="form-control"  id="InviteeEmail" placeholder="InviteeEmail"/><button type="button" style="  margin-left: 10px;  float: left;  margin-top: 2px;" class="btn btn-sm btn-primary"onclick="addToInvitedList()">Add to List</button>
                    <!--<button type="button" style="  margin-left: 10px;  float: left;  margin-top: 2px;" class="btn btn-sm btn-primary"onclick="inviteList()">Invite</button>-->
                </div>
                <div class="col-xs-12 form-group">
                    <div id="InvitedList">
                    </div>
                </div>
            </form>
        </div>
    </div>






    </body>
</html>                                		                                		